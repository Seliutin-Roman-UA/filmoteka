async function a(a){try{const t=await fetch(`https://api.themoviedb.org/3/trending/all/day?api_key=09fddff29ca445d38e447ae99342142f&page=${a}`);return await t.json()}catch(a){console.log("i am so sorry",a.message)}}async function t(a){let t="";"movie"===a&&(t="https://api.themoviedb.org/3/genre/movie/list?api_key=09fddff29ca445d38e447ae99342142f&language=en-US"),"tv"===a&&(t="https://api.themoviedb.org/3/genre/tv/list?api_key=09fddff29ca445d38e447ae99342142f&language=en-US");try{const a=await fetch(t),e=await a.json(),n={};return e.genres.forEach((a=>n[a.id]=a.name)),n}catch(a){console.log("i am so sorry",a.message)}}function e(){let a="";0===n.pagination.arrowLeft?a+='<span class="pag_arrowleft grey">\n                    <svg class="btn__icon">\n                      <use href="#arrowleft"></use>\n                    </svg></span>':a+='<span class="pag_arrowleft">\n                    <svg class="btn__icon">\n                      <use href="#arrowleft"></use>\n                    </svg></span>',1===n.pagination.buttonStart&&(a+='<span class="pag_block" data-page="1">1</span>'),1===n.pagination.gapLeft&&(a+='<span class="pag_dots">...</span>'),n.pagination.button.forEach(((t,e)=>{1===t&&(e+1===Number(n.currentPage)?a+=`<span class="pag_block active" data-page="${e+1}">${e+1}</span>`:a+=`<span class="pag_block " data-page="${e+1}">${e+1}</span>`)})),1===n.pagination.gapRight&&(a+='<span class="pag_dots">...</span>'),1===n.pagination.buttonFinish&&(a+=`<span class="pag_block" data-page="${n.totalPages}">${n.totalPages}</span>`),0===n.pagination.arrowRight?a+='<span class="pag_arrowright grey">\n                    <svg class="btn__icon">\n                      <use href="#arrowright"></use>\n                    </svg></span>':a+='<span class="pag_arrowright">\n                    <svg class="btn__icon">\n                      <use href="#arrowright"></use>\n                    </svg></span>',o.pagination.innerHTML=a,document.querySelector(".pag_arrowleft").addEventListener("click",(()=>{n.changeCurrentPage(n.currentPage-1)})),document.querySelector(".pag_arrowright").addEventListener("click",(()=>{n.changeCurrentPage(n.currentPage+1)})),document.querySelectorAll(".pag_block").forEach((a=>{a.addEventListener("click",(a=>{console.log(a.target.dataset.page),n.changeCurrentPage(a.target.dataset.page)}))}))}const n={currentPage:1,totalPages:1,pagination:{arrowLeft:null,buttonStart:null,gapLeft:null,button:[],gapRight:null,buttonFinish:null,arrowRight:null},query:null,fillpaginationButton(){let a,t;if(numberPage=this.currentPage-1,totalPages=this.totalPages-1,console.log("строим по индексу",numberPage),this.totalPages<5){for(i=0;i<=totalPages;i++)this.pagination.button[i]=1;return this.pagination.arrowLeft=0,this.pagination.buttonStart=0,this.pagination.gapLeft=0,this.pagination.gapRight=0,this.pagination.buttonFinish=0,void(this.pagination.arrowRight=0)}for(a=numberPage-2,t=numberPage+2,numberPage<3&&(a=0,t=4),totalPages-numberPage<3&&(a=totalPages-4,t=totalPages),i=0;i<=totalPages;i++)this.pagination.button[i]=0,i>=a&&i<=t&&(this.pagination.button[i]=1);this.pagination.arrowLeft=numberPage>0?1:0,this.pagination.buttonStart=a>=2?1:0,this.pagination.gapLeft=a>=1?1:0,this.pagination.gapRight=totalPages-t>0?1:0,this.pagination.buttonFinish=totalPages-t<=1?0:1,this.pagination.arrowRight=t<totalPages?1:0},async changeCurrentPage(a){const t=Number(a);if(t<1)return"reject";if(t>this.totalPages)return"reject";this.currentPage=t;const i=await this.query(t);var g;n.totalPages=i.total_pages,this.fillpaginationButton(),g=i.results,o.gallary.innerHTML=g.map((a=>{let t="";switch(a.media_type){case"movie":return t=0===a.genre_ids.length?"":a.genre_ids.map((a=>s[a])).join(", "),` <li class="card" data-id="${a.id}" data-media_type="${a.media_type}">\n            <img class="card__img" src="${a.poster_path?`https://image.tmdb.org/t/p/w500${a.poster_path}`:"./noimage.c59940df.jpg"}" alt="poster">\n            <p class="card__name">${a.title}</p>\n            <p class="card__info"><span class="card__ganre">${t} |</span>\n            <span>${a.release_date?a.release_date.slice(0,4):"unknown"}</span>\n            <span class="card__rating"> ${a.popularity?a.popularity.toFixed(1):"unknown"}</span></p>\n            </li>`;case"tv":return t=0===a.genre_ids.length?"":a.genres=a.genre_ids.map((a=>r[a])).join(", "),` <li class="card" data-id="${a.id} data-media_type="${a.media_type}">\n            <img class="card__img" src="${a.poster_path?`https://image.tmdb.org/t/p/w500${a.poster_path}`:"./noimage.c59940df.jpg"}" alt="poster">\n            <p class="card__name">${a.name}</p>\n            <p class="card__info"><span class="card__ganre">${t} |</span>\n            <span>${a.first_air_date?a.first_air_date.slice(0,4):"unknown"}</span>\n            <span class="card__rating"> ${a.popularity?a.popularity.toFixed(1):"unknown"}</span></p>\n            </li>`;case"person":return` <li class="card">\n            <img class="card__img" src="${a.profile_path?`https://image.tmdb.org/t/p/w500${a.profile_path}`:"./noimage.c59940df.jpg"}" alt="poster">\n            <p class="card__name">${a.name}</p>\n            <p class="card__info"><span class="card__ganre">person |</span>\n                 <span class="card__rating"> ${a.popularity?a.popularity.toFixed(1):"unknown"}</span></p>\n            </li>`}})).join(""),e()}};let s={},r={};const o={gallary:document.querySelector(".gallery"),pagination:document.querySelector(".pagination"),searchForm:document.querySelector(".searchform")};o.searchForm.addEventListener("submit",(function(a){var t;a.preventDefault(),n.query=(t=a.currentTarget.elements.string.value,async function(a){try{const e=await fetch(`https://api.themoviedb.org/3/search/movie?api_key=09fddff29ca445d38e447ae99342142f&page=${a}&query=${t}`),n=await e.json();return{total_pages:n.total_pages,results:n.results.map((a=>({...a,media_type:"movie"})))}}catch(a){console.log("i am so sorry",a.message)}}),n.changeCurrentPage(1)})),console.log("Hello MAIN"),async function(){s=await t("movie"),r=await t("tv"),n.query=a,n.changeCurrentPage(1)}(),console.log("Hello INDEX");
//# sourceMappingURL=index.d5fc6841.js.map
